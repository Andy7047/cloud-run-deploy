steps:
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['config','set','project','$_PROJECT_ID']
  #deploy to cloud run
  - name: 'gcr.io/cloud-builders/gcloud'
    args:
    - 'run'

    - 'deploy'

    - '${_EXEC_SERVICE_NAME}'

    - '--image'

    - '${_LOCATION}-docker.pkg.dev/$_PROJECT_ID/${_REPOSITORY}/${_EXEC_SERVICE_NAME}:${_VERSION}'

    - '--region'

    - '${_LOCATION}'

    - '--platform'

    - 'managed'

options:
  logging: CLOUD_LOGGING_ONLY

substitutions:
    _PROJECT_ID: 'aible-gcp-containers-beta'
    _LOCATION: 'us-central1'
    _EXEC_SERVICE_NAME: 'aible-exec'
    _REPOSITORY: 'gcp'
    _VERSION: '216e458'
    _PORT: '80'
 
images:
  - '${_LOCATION}-docker.pkg.dev/$_PROJECT_ID/${_REPOSITORY}/${_EXEC_SERVICE_NAME}:${_VERSION}'
